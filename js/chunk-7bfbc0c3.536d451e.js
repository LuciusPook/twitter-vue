(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bfbc0c3"],{3353:function(e,t,a){"use strict";a("b5fd")},"6f1a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tweet__container"},[e.isReplying?s("ReplyModal",{attrs:{tweetId:e.clickedTweetId},on:{"after-submit-reply":e.afterSubmitReply}}):e._e(),e.isLoading?s("Spinner"):[s("div",{staticClass:"tweet__navbar"},[s("a",{staticClass:"tweet__navbar--prev",on:{click:function(t){return e.$router.back()}}}),s("div",{staticClass:"tweet__navbar--info"},[e._v("推文")])]),s("div",{staticClass:"tweet__card"},[s("div",{staticClass:"tweet__title"},[s("div",{staticClass:"tweet__avatar--container"},[s("router-link",{attrs:{to:{name:"user",params:{id:e.tweet.User.id}}}},[s("img",{staticClass:"tweet__avatar",attrs:{src:e._f("emptyImage")(e.tweet.User.avatar),alt:""}})])],1),s("div",{staticClass:"tweet__title--info"},[s("h3",{staticClass:"tweet__title--name"},[e._v(e._s(e.tweet.User.name))]),s("router-link",{attrs:{to:{name:"user",params:{id:e.tweet.User.id}}}},[s("p",{staticClass:"tweet__title--account"},[e._v("@"+e._s(e.tweet.User.account))])])],1)]),s("p",{staticClass:"tweet__context"},[e._v(" "+e._s(e.tweet.description)+" ")]),s("span",{staticClass:"tweet__time"},[e._v(e._s(e._f("timeTransForm")(e.tweet.createdAt)))]),s("div",{staticClass:"tweet__counts"},[s("span",{staticClass:"tweet__commentCounts"},[e._v(e._s(e.tweet.reply_count)),s("span",[e._v("回覆")])]),s("span",{staticClass:"tweet__likeCounts"},[e._v(e._s(e.tweet.like_count)),s("span",[e._v("喜歡次數")])])]),s("div",{staticClass:"tweet__interactions"},[s("img",{staticClass:"tweet__commentBtn",attrs:{src:a("0fac"),alt:""},on:{click:function(t){return e.handleReplyModalToggle(e.tweet.id)}}}),e.tweet.isLiked?s("img",{staticClass:"tweet__likeBtn",attrs:{src:a("2849"),alt:""},on:{click:function(t){return e.deleteLike(e.tweet.id)}}}):s("img",{staticClass:"tweet__likeBtn",attrs:{src:a("5292"),alt:""},on:{click:function(t){return e.addLike(e.tweet.id)}}})])]),s("div",{staticClass:"tweet__replies--container scroll"},[s("ul",{staticClass:"tweet__replies"},e._l(e.tweetReplies,(function(t){return s("li",{key:t.id,staticClass:"tweet__reply"},[s("div",{staticClass:"reply__avatar--container"},[s("img",{staticClass:"reply__avatar",attrs:{src:e._f("emptyImage")(t.User.avatar),alt:""}})]),s("div",{staticClass:"tweet__reply--content"},[s("div",{staticClass:"tweet__reply--title"},[s("h3",{staticClass:"reply__user--name"},[e._v(e._s(t.User.name))]),s("span",{staticClass:"reply__user--account"},[s("router-link",{attrs:{to:{name:"user",params:{id:t.User.id}}}},[s("span",[e._v(e._s(t.User.account))])]),s("span",[e._v("．"+e._s(e._f("fromNow")(t.createdAt)))])],1)]),s("p",{staticClass:"tweet__reply--tag"},[s("span",[e._v("回覆")]),s("router-link",{attrs:{to:{name:"user",params:{id:e.tweet.User.id}}}},[s("span",{staticClass:"tweet__account"},[e._v(" "+e._s(e.tweet.User.account)+" ")])])],1),s("p",{staticClass:"tweet__reply--text"},[e._v(" "+e._s(t.comment)+" ")])])])})),0)])]],2)},r=[],i=a("2909"),n=a("1da1"),c=a("5530"),o=(a("96cf"),a("a4d3"),a("e01a"),a("2797")),l=a("2375"),u=a("6783"),_=a("2fa3"),d=a("2708"),w=a("2f62"),p={name:"Tweet",components:{ReplyModal:o["a"],Spinner:l["a"]},mixins:[d["b"],d["c"],d["a"]],data:function(){return{tweet:{},tweetReplies:[],isLoading:!1}},computed:Object(c["a"])({},Object(w["b"])(["isReplying"])),created:function(){var e=this.$route.params.id;this.fetchTweet(e),this.fetchTweetReplies(e)},beforeRouteUpdate:function(e,t,a){var s=e.params.id;this.fetchTweet(s),this.fetchTweetReplies(s),a()},methods:{fetchTweet:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r,i,n,o,l,d,w,p,f;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isLoading=!0,a.prev=1,a.next=4,u["a"].getTweet({tweetId:e});case 4:if(s=a.sent,200===s.status){a.next=7;break}throw new Error(s.statusText);case 7:r=s.data,i=r.id,n=r.description,o=r.UserId,l=r.createdAt,d=r.like_count,w=r.reply_count,p=r.User,f=r.isLiked,t.tweet=Object(c["a"])(Object(c["a"])({},t.tweet),{},{id:i,description:n,UserId:o,createdAt:l,like_count:d,reply_count:w,User:p,isLiked:f}),t.isLoading=!1,a.next=18;break;case 13:a.prev=13,a.t0=a["catch"](1),t.isLoading=!1,console.log("error",a.t0),_["a"].fire({icon:"error",title:"無法得到推文資料，請稍後再試!"});case 18:case"end":return a.stop()}}),a,null,[[1,13]])})))()},fetchTweetReplies:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isLoading=!0,a.prev=1,a.next=4,u["a"].reply.getReplies({tweetId:e});case 4:if(s=a.sent,200===s.status){a.next=7;break}throw new Error(s.statusText);case 7:r=s.data,t.tweetReplies=Object(i["a"])(r),t.isLoading=!1,a.next=17;break;case 12:a.prev=12,a.t0=a["catch"](1),t.isLoading=!1,console.log("error",a.t0),_["a"].fire({icon:"error",title:"無法得到推文回覆，請稍後再試!"});case 17:case"end":return a.stop()}}),a,null,[[1,12]])})))()},addLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u["a"].like.addLike({tweetId:e});case 3:if(s=a.sent,200===s.status){a.next=6;break}throw new Error(s.statusText);case 6:t.tweet.isLiked=!0,_["a"].fire({icon:"success",title:"成功對推文按讚"}),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log("error",a.t0),_["a"].fire({icon:"error",title:"無法對推文按讚，請稍後再試"});case 14:case"end":return a.stop()}}),a,null,[[0,10]])})))()},deleteLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u["a"].like.deleteLike({tweetId:e});case 3:if(s=a.sent,200===s.status){a.next=6;break}throw new Error(s.statusText);case 6:t.tweet.isLiked=!1,_["a"].fire({icon:"success",title:"成功取消推文按讚"}),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log("error",a.t0),_["a"].fire({icon:"error",title:"無法取消推文按讚，請稍後再試"});case 14:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleReplyModalToggle:function(e){this.$store.commit("toggleReplyModal"),this.clickedTweetId=e},afterSubmitReply:function(e){200===e.status?(this.tweet.reply_count++,this.fetchTweetReplies(this.tweet.id),_["a"].fire({icon:"success",title:"成功回覆推文"})):_["a"].fire({icon:"error",title:"無法回覆推文，請稍後再試!"})}}},f=p,v=(a("3353"),a("2877")),m=Object(v["a"])(f,s,r,!1,null,"2bc7c3a0",null);t["default"]=m.exports},b5fd:function(e,t,a){}}]);
//# sourceMappingURL=chunk-7bfbc0c3.536d451e.js.map